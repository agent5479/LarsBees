<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BeeMarshall - Secrets Debug Console</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <!-- BeeMarshall Branding -->
    <link href="css/brand.css" rel="stylesheet">
    
    <style>
        .debug-section {
            background: var(--white);
            border: 2px solid var(--dark-yellow);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow-hive);
        }
        
        .debug-header {
            background: var(--light-yellow);
            border-bottom: 2px solid var(--dark-yellow);
            padding: 1rem;
            margin: -1.5rem -1.5rem 1.5rem -1.5rem;
            border-radius: var(--radius-lg) var(--radius-lg) 0 0;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-success { background-color: var(--success); }
        .status-warning { background-color: var(--warning); }
        .status-danger { background-color: var(--danger); }
        .status-info { background-color: var(--info); }
        
        .code-block {
            background: var(--gray-100);
            border: 1px solid var(--gray-300);
            border-radius: var(--radius-md);
            padding: 1rem;
            font-family: var(--font-family-mono);
            font-size: var(--font-size-sm);
            overflow-x: auto;
            white-space: pre-wrap;
        }
        
        .test-button {
            margin: 0.25rem;
        }
        
        .log-entry {
            padding: 0.5rem;
            margin: 0.25rem 0;
            border-radius: var(--radius-sm);
            font-family: var(--font-family-mono);
            font-size: var(--font-size-sm);
        }
        
        .log-success { background: var(--bg-success); border-left: 4px solid var(--success); }
        .log-warning { background: var(--bg-warning); border-left: 4px solid var(--warning); }
        .log-danger { background: var(--bg-danger); border-left: 4px solid var(--danger); }
        .log-info { background: var(--bg-info); border-left: 4px solid var(--info); }
        
        .secret-value {
            font-family: var(--font-family-mono);
            background: var(--gray-100);
            padding: 0.25rem 0.5rem;
            border-radius: var(--radius-sm);
            word-break: break-all;
        }
        
        .masked-secret {
            color: var(--gray-500);
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container-fluid py-4">
        <div class="row">
            <div class="col-12">
                <h1 class="text-center mb-4">
                    <i class="bi bi-bug-fill text-hive-primary"></i>
                    BeeMarshall Secrets Debug Console
                </h1>
                <p class="text-center text-muted mb-4">
                    Comprehensive testing and debugging for GitHub Secrets integration
                </p>
            </div>
        </div>

        <!-- Environment Variables Status -->
        <div class="debug-section">
            <div class="debug-header">
                <h3><i class="bi bi-gear-fill"></i> Environment Variables Status</h3>
            </div>
            <div id="envStatus"></div>
        </div>

        <!-- Admin Accounts Testing -->
        <div class="debug-section">
            <div class="debug-header">
                <h3><i class="bi bi-person-check-fill"></i> Admin Accounts Testing</h3>
            </div>
            <div id="adminAccountsStatus"></div>
            <div class="mt-3">
                <h5>Test Authentication:</h5>
                <div class="row">
                    <div class="col-md-6">
                        <input type="text" id="testUsername" class="form-control mb-2" placeholder="Username">
                    </div>
                    <div class="col-md-6">
                        <input type="password" id="testPassword" class="form-control mb-2" placeholder="Password">
                    </div>
                </div>
                <button class="btn btn-primary test-button" onclick="testAuthentication()">
                    <i class="bi bi-key-fill"></i> Test Login
                </button>
                <button class="btn btn-outline-primary test-button" onclick="testAllAccounts()">
                    <i class="bi bi-people-fill"></i> Test All Accounts
                </button>
            </div>
        </div>

        <!-- Firebase Configuration Testing -->
        <div class="debug-section">
            <div class="debug-header">
                <h3><i class="bi bi-cloud-fill"></i> Firebase Configuration Testing</h3>
            </div>
            <div id="firebaseStatus"></div>
            <div class="mt-3">
                <button class="btn btn-primary test-button" onclick="testFirebaseConnection()">
                    <i class="bi bi-wifi"></i> Test Firebase Connection
                </button>
                <button class="btn btn-outline-primary test-button" onclick="testFirebaseAuth()">
                    <i class="bi bi-shield-check"></i> Test Firebase Auth
                </button>
            </div>
        </div>

        <!-- GitHub Actions Workflow Status -->
        <div class="debug-section">
            <div class="debug-header">
                <h3><i class="bi bi-github"></i> GitHub Actions Workflow Status</h3>
            </div>
            <div id="workflowStatus"></div>
            <div class="mt-3">
                <button class="btn btn-primary test-button" onclick="checkWorkflowStatus()">
                    <i class="bi bi-arrow-clockwise"></i> Check Workflow Status
                </button>
                <button class="btn btn-outline-primary test-button" onclick="triggerWorkflow()">
                    <i class="bi bi-play-fill"></i> Trigger Workflow
                </button>
            </div>
        </div>

        <!-- Live Debug Log -->
        <div class="debug-section">
            <div class="debug-header">
                <h3><i class="bi bi-terminal-fill"></i> Live Debug Log</h3>
                <button class="btn btn-sm btn-outline-secondary" onclick="clearLog()">
                    <i class="bi bi-trash"></i> Clear Log
                </button>
            </div>
            <div id="debugLog" style="max-height: 400px; overflow-y: auto; background: var(--gray-100); padding: 1rem; border-radius: var(--radius-md);"></div>
        </div>

        <!-- System Information -->
        <div class="debug-section">
            <div class="debug-header">
                <h3><i class="bi bi-info-circle-fill"></i> System Information</h3>
            </div>
            <div id="systemInfo"></div>
        </div>

        <!-- Troubleshooting Guide -->
        <div class="debug-section">
            <div class="debug-header">
                <h3><i class="bi bi-wrench"></i> Troubleshooting Guide</h3>
            </div>
            <div id="troubleshootingGuide"></div>
        </div>

        <!-- Quick Actions -->
        <div class="debug-section">
            <div class="debug-header">
                <h3><i class="bi bi-lightning-fill"></i> Quick Actions</h3>
            </div>
            <div class="d-flex flex-wrap gap-2">
                <button class="btn btn-success" onclick="runAllTests()">
                    <i class="bi bi-play-circle-fill"></i> Run All Tests
                </button>
                <button class="btn btn-warning" onclick="exportDebugInfo()">
                    <i class="bi bi-download"></i> Export Debug Info
                </button>
                <button class="btn btn-info" onclick="openMainApp()">
                    <i class="bi bi-box-arrow-up-right"></i> Open Main App
                </button>
                <button class="btn btn-outline-danger" onclick="resetAll()">
                    <i class="bi bi-arrow-clockwise"></i> Reset All
                </button>
            </div>
        </div>
    </div>

    <!-- Load Environment Configuration -->
    <script src="js/env-config.js"></script>
    <script src="js/config.js"></script>
    <script src="js/core.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>

    <script>
        // Debug Console JavaScript
        let debugLog = [];
        let testResults = {};

        // Initialize debug console
        document.addEventListener('DOMContentLoaded', function() {
            log('Debug console initialized', 'info');
            
            // Check if env-config.js loaded successfully
            if (typeof window.ENV_GBTECH_USERNAME === 'undefined') {
                log('❌ env-config.js not loaded - GitHub Secrets not injected', 'danger');
                log('This indicates the GitHub Actions workflow may not have run or failed', 'warning');
            } else {
                log('✅ env-config.js loaded successfully', 'success');
            }
            
            updateAllStatus();
            
            // Auto-refresh every 5 seconds
            setInterval(updateAllStatus, 5000);
        });

        // Logging function
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = {
                timestamp,
                message,
                type
            };
            debugLog.push(logEntry);
            
            const logElement = document.getElementById('debugLog');
            const logDiv = document.createElement('div');
            logDiv.className = `log-entry log-${type}`;
            logDiv.innerHTML = `<strong>[${timestamp}]</strong> ${message}`;
            logElement.appendChild(logDiv);
            logElement.scrollTop = logElement.scrollHeight;
            
            console.log(`[${type.toUpperCase()}] ${message}`);
        }

        // Update all status sections
        function updateAllStatus() {
            updateEnvironmentStatus();
            updateAdminAccountsStatus();
            updateFirebaseStatus();
            updateWorkflowStatus();
            updateSystemInfo();
            updateTroubleshootingGuide();
        }

        // Environment Variables Status
        function updateEnvironmentStatus() {
            const envVars = [
                'ENV_GBTECH_USERNAME',
                'ENV_GBTECH_PASSWORD',
                'ENV_LARS_USERNAME',
                'ENV_LARS_PASSWORD',
                'ENV_FIREBASE_API_KEY',
                'ENV_FIREBASE_AUTH_DOMAIN',
                'ENV_FIREBASE_DATABASE_URL',
                'ENV_FIREBASE_PROJECT_ID',
                'ENV_FIREBASE_STORAGE_BUCKET',
                'ENV_FIREBASE_MESSAGING_SENDER_ID',
                'ENV_FIREBASE_APP_ID'
            ];

            let html = '';
            
            // Check if env-config.js is loaded
            if (typeof window.ENV_GBTECH_USERNAME === 'undefined') {
                html += `
                    <div class="alert alert-danger">
                        <h5><i class="bi bi-exclamation-triangle-fill"></i> Environment Configuration Not Loaded</h5>
                        <p>The <code>env-config.js</code> file is not loaded. This means:</p>
                        <ul>
                            <li>GitHub Actions workflow may not have run</li>
                            <li>GitHub Secrets may not be properly configured</li>
                            <li>You may be viewing a cached version</li>
                        </ul>
                        <p><strong>Solutions:</strong></p>
                        <ol>
                            <li>Check if GitHub Actions workflow has completed</li>
                            <li>Verify GitHub Secrets are properly set</li>
                            <li>Clear browser cache and refresh</li>
                            <li>Wait a few minutes for deployment to complete</li>
                        </ol>
                    </div>
                `;
            } else {
                html += '<div class="row">';
                envVars.forEach(varName => {
                    const value = window[varName];
                    const status = value ? (value.includes('[') || value.includes('YOUR_') ? 'warning' : 'success') : 'danger';
                    const statusText = value ? (value.includes('[') || value.includes('YOUR_') ? 'Placeholder' : 'Set') : 'Missing';
                    
                    html += `
                        <div class="col-md-6 mb-2">
                            <div class="d-flex align-items-center">
                                <span class="status-indicator status-${status}"></span>
                                <strong>${varName}:</strong>
                                <span class="ms-2 badge bg-${status === 'success' ? 'success' : status === 'warning' ? 'warning' : 'danger'}">${statusText}</span>
                            </div>
                            <div class="secret-value mt-1">
                                ${value ? (varName.includes('PASSWORD') || varName.includes('KEY') ? '••••••••' : value) : 'Not set'}
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
            }
            
            document.getElementById('envStatus').innerHTML = html;
        }

        // Admin Accounts Status
        function updateAdminAccountsStatus() {
            let html = '';
            
            if (window.SecureConfig) {
                const accounts = window.SecureConfig.getAdminAccounts();
                const accountKeys = Object.keys(accounts);
                
                html += `<p><span class="status-indicator status-success"></span><strong>SecureConfig loaded:</strong> ${accountKeys.length} accounts found</p>`;
                
                if (accountKeys.length > 0) {
                    html += '<div class="row">';
                    accountKeys.forEach(key => {
                        const account = accounts[key];
                        html += `
                            <div class="col-md-4 mb-3">
                                <div class="card">
                                    <div class="card-body">
                                        <h6 class="card-title">${account.username}</h6>
                                        <p class="card-text">
                                            <small class="text-muted">Role: ${account.role}</small><br>
                                            <small class="text-muted">Tenant: ${account.tenantId}</small><br>
                                            <small class="text-muted">Password: ${account.password ? '••••••••' : 'Not set'}</small>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                    html += '</div>';
                } else {
                    html += '<p class="text-warning">No admin accounts loaded</p>';
                }
            } else {
                html += '<p class="text-danger">SecureConfig not available</p>';
            }
            
            document.getElementById('adminAccountsStatus').innerHTML = html;
        }

        // Firebase Status
        function updateFirebaseStatus() {
            let html = '';
            
            const firebaseConfig = {
                apiKey: window.ENV_FIREBASE_API_KEY,
                authDomain: window.ENV_FIREBASE_AUTH_DOMAIN,
                databaseURL: window.ENV_FIREBASE_DATABASE_URL,
                projectId: window.ENV_FIREBASE_PROJECT_ID,
                storageBucket: window.ENV_FIREBASE_STORAGE_BUCKET,
                messagingSenderId: window.ENV_FIREBASE_MESSAGING_SENDER_ID,
                appId: window.ENV_FIREBASE_APP_ID
            };
            
            const configKeys = Object.keys(firebaseConfig);
            const validConfig = configKeys.every(key => firebaseConfig[key] && !firebaseConfig[key].includes('YOUR_'));
            
            html += `<p><span class="status-indicator status-${validConfig ? 'success' : 'warning'}"></span><strong>Firebase Config:</strong> ${validConfig ? 'Valid' : 'Invalid/Incomplete'}</p>`;
            
            if (validConfig) {
                html += '<div class="code-block">';
                html += `Project ID: ${firebaseConfig.projectId}\n`;
                html += `Database URL: ${firebaseConfig.databaseURL}\n`;
                html += `Auth Domain: ${firebaseConfig.authDomain}`;
                html += '</div>';
            } else {
                html += '<p class="text-warning">Firebase configuration contains placeholder values</p>';
            }
            
            document.getElementById('firebaseStatus').innerHTML = html;
        }

        // Workflow Status
        function updateWorkflowStatus() {
            let html = '';
            
            // Check if we're on GitHub Pages
            const isGitHubPages = window.location.hostname.includes('github.io');
            const isLocal = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
            
            html += `<p><span class="status-indicator status-${isGitHubPages ? 'success' : isLocal ? 'warning' : 'info'}"></span><strong>Environment:</strong> ${isGitHubPages ? 'GitHub Pages' : isLocal ? 'Local Development' : 'Unknown'}</p>`;
            
            if (isGitHubPages) {
                html += '<p class="text-success">Running on GitHub Pages - secrets should be injected</p>';
            } else if (isLocal) {
                html += '<p class="text-warning">Running locally - using placeholder values</p>';
            }
            
            document.getElementById('workflowStatus').innerHTML = html;
        }

        // System Information
        function updateSystemInfo() {
            const info = {
                'User Agent': navigator.userAgent,
                'Platform': navigator.platform,
                'Language': navigator.language,
                'Online': navigator.onLine ? 'Yes' : 'No',
                'URL': window.location.href,
                'Timestamp': new Date().toISOString(),
                'Screen Resolution': `${screen.width}x${screen.height}`,
                'Viewport Size': `${window.innerWidth}x${window.innerHeight}`
            };
            
            let html = '<div class="row">';
            Object.entries(info).forEach(([key, value]) => {
                html += `
                    <div class="col-md-6 mb-2">
                        <strong>${key}:</strong>
                        <div class="secret-value">${value}</div>
                    </div>
                `;
            });
            html += '</div>';
            
            document.getElementById('systemInfo').innerHTML = html;
        }

        // Troubleshooting Guide
        function updateTroubleshootingGuide() {
            const isGitHubPages = window.location.hostname.includes('github.io');
            const envConfigLoaded = typeof window.ENV_GBTECH_USERNAME !== 'undefined';
            
            let html = '';
            
            if (!isGitHubPages) {
                html += `
                    <div class="alert alert-info">
                        <h5><i class="bi bi-info-circle-fill"></i> Local Development Mode</h5>
                        <p>You're running locally. The debug console will show placeholder values for environment variables.</p>
                        <p>To test with real secrets, deploy to GitHub Pages.</p>
                    </div>
                `;
            } else if (!envConfigLoaded) {
                html += `
                    <div class="alert alert-danger">
                        <h5><i class="bi bi-exclamation-triangle-fill"></i> GitHub Secrets Not Injected</h5>
                        <p>The GitHub Actions workflow has not run or failed. Here's how to fix it:</p>
                        
                        <h6>Step 1: Check GitHub Actions</h6>
                        <ol>
                            <li>Go to <a href="https://github.com/agent5479/LarsBees/actions" target="_blank">GitHub Actions</a></li>
                            <li>Look for the "Deploy to GitHub Pages" workflow</li>
                            <li>Check if it's running or has failed</li>
                        </ol>
                        
                        <h6>Step 2: Verify GitHub Secrets</h6>
                        <ol>
                            <li>Go to <a href="https://github.com/agent5479/LarsBees/settings/secrets/actions" target="_blank">Repository Secrets</a></li>
                            <li>Verify these secrets are set:
                                <ul>
                                    <li><code>GBTECH_USERNAME</code></li>
                                    <li><code>GBTECH_PASSWORD</code></li>
                                    <li><code>LARS_USERNAME</code></li>
                                    <li><code>LARS_PASSWORD</code></li>
                                    <li><code>FIREBASE_API_KEY</code></li>
                                    <li><code>FIREBASE_AUTH_DOMAIN</code></li>
                                    <li><code>FIREBASE_DATABASE_URL</code></li>
                                    <li><code>FIREBASE_PROJECT_ID</code></li>
                                    <li><code>FIREBASE_STORAGE_BUCKET</code></li>
                                    <li><code>FIREBASE_MESSAGING_SENDER_ID</code></li>
                                    <li><code>FIREBASE_APP_ID</code></li>
                                </ul>
                            </li>
                        </ol>
                        
                        <h6>Step 3: Trigger Workflow</h6>
                        <ol>
                            <li>Make a small change to any file (like adding a space)</li>
                            <li>Commit and push the change</li>
                            <li>This will trigger the GitHub Actions workflow</li>
                            <li>Wait 3-5 minutes for deployment to complete</li>
                        </ol>
                        
                        <h6>Step 4: Clear Cache</h6>
                        <ol>
                            <li>Hard refresh the page (Ctrl+F5 or Cmd+Shift+R)</li>
                            <li>Or clear browser cache completely</li>
                        </ol>
                    </div>
                `;
            } else {
                html += `
                    <div class="alert alert-success">
                        <h5><i class="bi bi-check-circle-fill"></i> System Working Correctly</h5>
                        <p>GitHub Secrets are properly injected and the system is working as expected.</p>
                    </div>
                `;
            }
            
            document.getElementById('troubleshootingGuide').innerHTML = html;
        }

        // Test Functions
        function testAuthentication() {
            const username = document.getElementById('testUsername').value;
            const password = document.getElementById('testPassword').value;
            
            if (!username || !password) {
                log('Please enter both username and password', 'warning');
                return;
            }
            
            log(`Testing authentication for: ${username}`, 'info');
            
            if (window.SecureConfig) {
                const accounts = window.SecureConfig.getAdminAccounts();
                const account = Object.values(accounts).find(acc => 
                    acc.username.toLowerCase() === username.toLowerCase() && acc.password === password
                );
                
                if (account) {
                    log(`✅ Authentication successful for ${username}`, 'success');
                } else {
                    log(`❌ Authentication failed for ${username}`, 'danger');
                }
            } else {
                log('❌ SecureConfig not available', 'danger');
            }
        }

        function testAllAccounts() {
            log('Testing all admin accounts...', 'info');
            
            if (window.SecureConfig) {
                const accounts = window.SecureConfig.getAdminAccounts();
                Object.entries(accounts).forEach(([key, account]) => {
                    log(`Testing ${account.username}...`, 'info');
                    // Note: We can't test passwords without knowing them
                });
            } else {
                log('❌ SecureConfig not available', 'danger');
            }
        }

        function testFirebaseConnection() {
            log('Testing Firebase connection...', 'info');
            
            try {
                const firebaseConfig = {
                    apiKey: window.ENV_FIREBASE_API_KEY,
                    authDomain: window.ENV_FIREBASE_AUTH_DOMAIN,
                    databaseURL: window.ENV_FIREBASE_DATABASE_URL,
                    projectId: window.ENV_FIREBASE_PROJECT_ID,
                    storageBucket: window.ENV_FIREBASE_STORAGE_BUCKET,
                    messagingSenderId: window.ENV_FIREBASE_MESSAGING_SENDER_ID,
                    appId: window.ENV_FIREBASE_APP_ID
                };
                
                if (firebaseConfig.apiKey && !firebaseConfig.apiKey.includes('YOUR_')) {
                    firebase.initializeApp(firebaseConfig);
                    const database = firebase.database();
                    log('✅ Firebase initialized successfully', 'success');
                } else {
                    log('❌ Firebase configuration invalid', 'danger');
                }
            } catch (error) {
                log(`❌ Firebase error: ${error.message}`, 'danger');
            }
        }

        function testFirebaseAuth() {
            log('Testing Firebase authentication...', 'info');
            // Add Firebase auth testing here
        }

        function checkWorkflowStatus() {
            log('Checking GitHub Actions workflow status...', 'info');
            
            // Check if we're on GitHub Pages
            const isGitHubPages = window.location.hostname.includes('github.io');
            
            if (isGitHubPages) {
                log('✅ Running on GitHub Pages - checking for env-config.js', 'info');
                
                // Try to fetch the env-config.js file
                fetch('js/env-config.js')
                    .then(response => {
                        if (response.ok) {
                            log('✅ env-config.js found on GitHub Pages', 'success');
                            return response.text();
                        } else {
                            log('❌ env-config.js not found on GitHub Pages (404)', 'danger');
                            throw new Error('env-config.js not found');
                        }
                    })
                    .then(content => {
                        if (content.includes('YOUR_') || content.includes('[')) {
                            log('⚠️ env-config.js contains placeholder values - GitHub Secrets not injected', 'warning');
                        } else {
                            log('✅ env-config.js contains real values - GitHub Secrets injected', 'success');
                        }
                    })
                    .catch(error => {
                        log(`❌ Error checking env-config.js: ${error.message}`, 'danger');
                        log('This indicates the GitHub Actions workflow has not run or failed', 'warning');
                    });
            } else {
                log('⚠️ Not running on GitHub Pages - using local configuration', 'warning');
            }
        }

        function triggerWorkflow() {
            log('Triggering GitHub Actions workflow...', 'info');
            
            // Open GitHub Actions page in new tab
            const repoUrl = 'https://github.com/agent5479/LarsBees/actions';
            window.open(repoUrl, '_blank');
            
            log('Opened GitHub Actions page - check if workflow is running', 'info');
            log('If no workflow is running, you may need to push a commit to trigger it', 'warning');
        }

        // Utility Functions
        function clearLog() {
            debugLog = [];
            document.getElementById('debugLog').innerHTML = '';
            log('Debug log cleared', 'info');
        }

        function runAllTests() {
            log('Running all tests...', 'info');
            updateAllStatus();
            testFirebaseConnection();
            log('All tests completed', 'success');
        }

        function exportDebugInfo() {
            const debugData = {
                timestamp: new Date().toISOString(),
                environment: {
                    isGitHubPages: window.location.hostname.includes('github.io'),
                    isLocal: window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1',
                    url: window.location.href
                },
                envVars: {
                    ENV_GBTECH_USERNAME: window.ENV_GBTECH_USERNAME,
                    ENV_GBTECH_PASSWORD: window.ENV_GBTECH_PASSWORD ? '••••••••' : 'Not set',
                    ENV_LARS_USERNAME: window.ENV_LARS_USERNAME,
                    ENV_LARS_PASSWORD: window.ENV_LARS_PASSWORD ? '••••••••' : 'Not set',
                    ENV_FIREBASE_API_KEY: window.ENV_FIREBASE_API_KEY ? '••••••••' : 'Not set',
                    ENV_FIREBASE_PROJECT_ID: window.ENV_FIREBASE_PROJECT_ID
                },
                adminAccounts: window.SecureConfig ? window.SecureConfig.getAdminAccounts() : 'Not available',
                debugLog: debugLog
            };
            
            const blob = new Blob([JSON.stringify(debugData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `beemarshall-debug-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            log('Debug info exported', 'success');
        }

        function openMainApp() {
            window.open('beemarshall-full.html', '_blank');
        }

        function resetAll() {
            if (confirm('Are you sure you want to reset all debug data?')) {
                clearLog();
                updateAllStatus();
                log('Debug console reset', 'info');
            }
        }
    </script>
</body>
</html>
